# 🎀 拽姐 Prompt 优化指南

## 📁 文件结构说明

```
src/
├── prompt_config.py     # 🎯 新的统一Prompt配置文件（你主要编辑这个）
├── prompts.py          # 📚 兼容性文件，导入prompt_config中的内容
└── tools/
    ├── roast.py        # 💥 毒舌工具
    ├── help.py         # 🆘 求助工具
    ├── seaking.py      # 🌊 海王模拟工具
    ├── severity.py     # 📊 严重程度分析工具
    └── search.py       # 🔍 搜索工具

test_prompts.py          # 🛠️ Prompt测试工具
```

## 🚀 快速开始

### 1. 编辑Prompt配置
主要编辑文件：`src/prompt_config.py`

这个文件包含了所有的prompt模板，按功能分类：
- **核心系统Prompt** - 拽姐人设与路由逻辑
- **毒舌模式Prompt** - 经典吐槽风格
- **求助模式Prompt** - 专业分析与建议  
- **海王模拟Prompt** - 对战练习系统
- **风险识别Prompt** - 恋爱脑程度评估

### 2. 测试Prompt效果

#### 交互式测试：
```bash
python test_prompts.py
```

#### 命令行测试：
```bash
# 测试预设场景
python test_prompts.py 轻度吐槽
python test_prompts.py 中度求助
python test_prompts.py 海王模拟
python test_prompts.py 危险情况
```

### 3. 测试命令参考

进入交互模式后，可用命令：

```bash
# 测试毒舌模式
roast 他说他很忙但是在游戏 中

# 测试求助模式  
help 他让我借钱给他，我该怎么办

# 测试海王模拟
seaking 开始练习 温柔暖男型

# 测试严重程度分析
severity 他威胁要发我的照片

# 查看所有预设场景
list

# 查看海王人设
personas
```

## 🎯 Prompt优化技巧

### 1. 毒舌模式优化
**目标**：保持拽姐特色，根据严重程度调整强度

**关键要素**：
- 口语化开头（"哎呀" "我说" "拜托"）
- 毒舌暴击（≤20字，一针见血）
- 恋爱意图翻译（戳破美化）
- 案例警示（可选，增强说服力）
- 去滤镜化剖析（≤50字，现实检验）
- 结尾金句（幽默夸张的总结）

**强度控制**：
- 轻：温和吐槽 "这不就是..."
- 中：明显犀利 "你这是..."  
- 重：高强度直怼 "醒醒吧..."

### 2. 求助模式优化
**目标**：专业分析+实用建议+拽姐收尾

**关键要素**：
- 现象命名（给问题贴标签）
- 操控手法简析（1-2句透析本质）
- 风险提示（必要时引用案例）
- 可执行动作（2-3个具体步骤）
- 拽姐式结尾（金句提醒）

**特殊情况**：
- 家暴/自伤/未成年人 → 收起毒舌，给求助渠道

### 3. 海王模拟优化
**目标**：真实训练场景+有效反击策略

**三段式结构**：
- 【海王】: 1句套路话（短、口语化、真实）
- 【你】: 可选回应建议（放括号内）
- 【拽姐旁白】: 点评+战术+得分(0-100)

**人设库扩展**：
- 高冷学霸型：知识优越感控制
- 温柔暖男型：道德绑架操控
- 霸道总裁型：权威感物质诱惑

### 4. 风险识别优化
**目标**：准确评估恋爱脑程度，及时预警

**评分标准**：
- 0-39轻：过度理想化，忽略红旗
- 40-69中：金钱付出，价值观改变  
- 70-89重：借钱转账，放弃工作学业
- 90-100危：家暴威胁，人身安全风险

## 🧪 测试场景库

### 当前预设场景：
1. **轻度吐槽** - 日常感情困惑
2. **中度求助** - 金钱纠纷建议
3. **海王模拟** - 对战训练场景
4. **危险情况** - 安全威胁处理

### 添加新场景：
在 `prompt_config.py` 的 `TEST_SCENARIOS` 中添加：

```python
"新场景名": {
    "user_input": "用户输入示例",
    "expected_tone": "期望的回复风格"
}
```

## 🔄 迭代优化流程

1. **🎨 修改prompt** - 在 `prompt_config.py` 中调整
2. **🧪 测试效果** - 用 `test_prompts.py` 验证
3. **📊 评估质量** - 检查是否符合预期
4. **🚀 部署更新** - 推送到线上服务
5. **📈 收集反馈** - 根据实际使用调整

## 💡 优化建议

### 人设一致性
- 保持28岁、理智、毒舌的核心特征
- 不同场景下灵活调整语气强度
- 危险情况能收起毒舌转为专业

### 输出格式控制  
- 强调"一段自然连贯的话"
- 避免条条框框的说教风格
- 控制长度，保持精炼有力

### 功能边界清晰
- 毒舌模式：吐槽+戳破+提醒
- 求助模式：分析+建议+指南
- 海王模拟：训练+实战+复盘

### 安全机制
- 危险信号自动切换专业模式
- 提供具体求助渠道信息
- 避免可能加剧风险的建议

## 🎯 实用checklist

优化每个prompt后，检查：

- ✅ 人设一致性 - 是否保持拽姐特色
- ✅ 语气适配度 - 是否根据严重程度调整  
- ✅ 输出格式 - 是否符合"一段话"要求
- ✅ 实用性 - 是否给出可执行的建议
- ✅ 安全性 - 危险情况是否正确处理
- ✅ 趣味性 - 是否保持适度幽默感

## 🚀 快速测试命令

```bash
# 快速测试所有场景
for scenario in 轻度吐槽 中度求助 海王模拟 危险情况; do
    echo "=== 测试 $scenario ==="
    python test_prompts.py "$scenario"
done
```

开始优化你的拽姐吧！🎀
